import{r as t,e as s,h as o,H as e,g as i}from"./p-75b8bc7c.js";import{S as r}from"./p-85cd1ecc.js";import{R as n}from"./p-36c6ce64.js";import{L as a}from"./p-9916c695.js";import{K as h,a as c,N as b}from"./p-dc27d7fa.js";var l=function(t,s,o,e){return new(o||(o=Promise))((function(i,r){function n(t){try{h(e.next(t))}catch(s){r(s)}}function a(t){try{h(e.throw(t))}catch(s){r(s)}}function h(t){var s;t.done?i(t.value):(s=t.value,s instanceof o?s:new o((function(t){t(s)}))).then(n,a)}h((e=e.apply(t,s||[])).next())}))};const u=class{constructor(o){t(this,o),this.sntInput=s(this,"sntInput",7),this.sntFocus=s(this,"sntFocus",7),this.sntBlur=s(this,"sntBlur",7),this.sntSearchSubmitted=s(this,"sntSearchSubmitted",7),this.focused=!1,this.expanded=!1,this.autoComplete=!1,this.ariaLabelledby=r.empty(),this.ariaLabel=r.empty(),this.languageJson=r.empty(),this.languageString=r.empty(),this.searchFunctionRef=r.empty(),this.value="",this.activeIndex=-1}activeIndexChange(t){this.autoComplete&&-1!=t&&(this.value=this.SearchSuggestion[this.activeIndex].title)}componentWillLoad(){if(r.isEmpty(this.hostElement.id))throw new Error(u.TAG_NAME+" must have a valid id.");this.searchFunctionRef&&n.getObjectReference(this.searchFunctionRef,window).then(t=>{this.searchFunction=t}),this.languageVariables=a.getVariablesFromString(this.languageString,["search"]),this.initKeyboardEventProcessor()}onClick(t){this.focused=this.expanded=!1,t.target.focus()}setFocus(){return l(this,void 0,void 0,(function*(){return this.input&&this.input.focus(),Promise.resolve()}))}getInputElement(){return l(this,void 0,void 0,(function*(){return Promise.resolve(this.input)}))}setSearchSuggestions(t){return l(this,void 0,void 0,(function*(){t&&(this.SearchSuggestion=t,this.expanded=this.SearchSuggestion.length>0)}))}onFocus(){this.focused=!0,this.sntFocus.emit(),this.updateSearchSuggestions()}onInput(t){const s=t.target;s&&(this.value=s.value,this.userInput=s.value),this.updateSearchSuggestions(),this.sntInput.emit(t)}onBlur(){this.expanded||(this.focused=!1)}onListboxClick(t){t.target&&"LI"==t.target.nodeName&&(this.activeIndex=t.target.dataset.index,this.selectItem(),this.focused=!1)}selectItem(){-1!==this.activeIndex&&(this.value=this.SearchSuggestion[this.activeIndex].title,this.expanded=!1)}clear(){this.expanded=!1,this.value=r.empty()}dismiss(){this.focused=this.expanded=!1}updateSearchSuggestions(){return l(this,void 0,void 0,(function*(){this.searchFunction&&(this.SearchSuggestion=yield this.searchFunction(this.input.value,a.isFrench()?a.LANGUAGE_ID.fr:a.LANGUAGE_ID.en,10),this.expanded=this.SearchSuggestion.length>0)}))}initKeyboardEventProcessor(){this.keyboardEventProcessor=h.newInstance().withKey(c.ARROW_UP,()=>this.setNextActiveIndex(b.BACKWARDS)).withKey(c.ARROW_DOWN,()=>this.setNextActiveIndex(b.FORWARDS)).withKey(c.HOME,()=>this.setNextActiveIndex(b.FIRST)).withKey(c.END,()=>this.setNextActiveIndex(b.LAST)).withKey(c.ENTER,()=>this.submit()).withKey(c.ESCAPE,()=>this.clear()).withKey(c.TAB,()=>this.dismiss()).build()}processKeyboardEvent(t){this.keyboardEventProcessor.process(t)}setNextActiveIndex(t){t==b.BACKWARDS?this.activeIndex<=0?(this.activeIndex=-1,this.restoreUserInput()):this.activeIndex-=1:t==b.FORWARDS?this.activeIndex>=this.SearchSuggestion.length-1?(this.activeIndex=-1,this.restoreUserInput()):this.activeIndex+=1:t==b.FIRST?this.activeIndex=0:t==b.LAST&&(this.activeIndex=this.SearchSuggestion.length-1)}highlightPattern(t,s){const e=t.split(s);if(e.length<=1)return t;const i=t.match(s);return e.reduce((t,s,e)=>i[e]?[...t,s,o("b",null,i[e])]:[...t,s],[])}submit(){this.selectItem(),-1!=this.activeIndex?window.location.href=this.SearchSuggestion[this.activeIndex].url:(this.sntSearchSubmitted.emit({keywords:this.value}),this.expanded=!1)}restoreUserInput(){this.value=this.userInput}render(){const t=this.hostElement.id?this.hostElement.id+"-textbox":null,s=this.hostElement.id?this.hostElement.id+"-listbox":null;return o(e,{class:{"search-combobox-has-focus":this.focused,"search-combobox-is-expanded":this.expanded}},o("snt-layout",{padding:this.padding},o("div",{class:"search-container"},o("div",{role:"combobox",id:this.hostElement.id?this.hostElement.id+"-combobox":null,"aria-haspopup":"listbox","aria-owns":s,"aria-expanded":this.expanded.toString(),class:"search-input-area"},o("snt-icon",{styleClasses:"iconNavSearch"}),r.notEmpty(this.ariaLabelledby)?o("label",{htmlFor:t,id:this.ariaLabelledby,class:"sr-only"},this.languageVariables.get("search")):null,o("input",{type:"search",id:t,role:"textbox","aria-labelledby":this.ariaLabelledby||null,"aria-autocomplete":"both","aria-controls":s,"aria-activedescendant":this.activeIndex>=0?"result-item-"+this.activeIndex:null,onInput:this.onInput.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),onKeyDown:this.processKeyboardEvent.bind(this),placeholder:this.languageVariables.get("search"),ref:t=>this.input=t,value:this.value,autoComplete:"off"})),o("ul",{id:s,role:"listbox",class:"search-results-area",onClick:this.onListboxClick.bind(this)},this.focused&&this.SearchSuggestion&&this.SearchSuggestion.length>0?this.SearchSuggestion.map((t,s)=>o("li",{role:"option","aria-selected":s==this.activeIndex,"aria-label":this.languageVariables.get("link to")+t.title,id:"result-item-"+s,class:{result:!0,"result-is-focused":s==this.activeIndex},"data-index":s},o("a",{href:t.url},this.highlightPattern(t.title,new RegExp(this.input.value,"ig"))))):null)),this.focused&&this.expanded?o("snt-backdrop",null):null))}get hostElement(){return i(this)}static get watchers(){return{activeIndex:["activeIndexChange"]}}};u.TAG_NAME="snt-search-combobox",u.style='snt-search-combobox{display:block;position:relative;background-color:#ffffff;width:100%;background-color:transparent}snt-search-combobox input{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:2.525rem;font-size:0.875rem;line-height:1.25rem}snt-search-combobox input::-webkit-search-cancel-button{position:relative;right:11px;-webkit-filter:brightness(0.6) contrast(1.03) grayscale(1);filter:brightness(0.6) contrast(1.03) grayscale(1)}snt-search-combobox snt-button button{display:none;position:absolute;right:0.5rem;top:0;bottom:0;margin:auto;font-size:1.125rem;line-height:1.125rem;color:#323232}snt-search-combobox snt-layout .spacings{overflow:unset}snt-search-combobox .search-container{position:relative}snt-search-combobox :focus{outline:none}snt-search-combobox snt-button{display:none}snt-search-combobox snt-icon{margin:0 0.625rem 0 1.25rem}snt-search-combobox input{border:none;border-radius:0;background-color:transparent}snt-search-combobox ul{list-style:none;margin:0;padding:0}snt-search-combobox ul li a{text-decoration:none;color:#323232;font-size:14px;line-height:23px}snt-search-combobox .search-input-area{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;background-color:#ffffff;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid #b2b2b2;border-radius:25px}snt-search-combobox .search-input-area:hover{border-color:#147582}snt-search-combobox .search-results-area{z-index:10;display:none;color:#323232;position:absolute;left:0;right:0;top:100%;width:100%;padding:0.625rem;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:left;border:1px solid transparent;border-top:none;border-bottom-left-radius:25px;border-bottom-right-radius:25px;background-color:white;height:400px;overflow-y:scroll}@media (min-width: 768px){snt-search-combobox .search-results-area{height:auto;overflow-y:auto}}snt-search-combobox .search-results-area:before{position:absolute;content:" ";height:1px;margin-right:auto;margin-left:auto;top:0;left:0;right:0;width:calc(100% - 2rem);background-color:#147582}snt-search-combobox .result{padding:0.3125rem 0.625rem;font-size:14px;line-height:23px;border-bottom:1px solid #e5e5e5}snt-search-combobox .result:last-child{border-bottom:none}snt-search-combobox.search-combobox-has-focus snt-backdrop{display:block;background-color:rgba(51, 51, 51, 0.75);z-index:5}snt-search-combobox.search-combobox-has-focus .search-input-area{border:3px solid #147582;margin:-2px}snt-search-combobox .result{cursor:default}snt-search-combobox .result:hover,snt-search-combobox .result.result-is-focused{background-color:#f8f8f8}snt-search-combobox .result b{pointer-events:none}snt-search-combobox .result:active{background-color:#147582}snt-search-combobox .result:active a{color:white}snt-search-combobox.theme-default .search-input-area{background-color:#ffffff;border:1px solid #b2b2b2}snt-search-combobox.theme-default .search-input-area:hover{border-color:#147582}snt-search-combobox.theme-default.search-combobox-has-focus .search-input-area{border:3px solid #147582}snt-search-combobox.theme-neutral .search-input-area{background-color:#ffffff;border:1px solid #e5e5e5}snt-search-combobox.theme-neutral .search-input-area:hover{border-color:#6ebac5}snt-search-combobox.theme-neutral.search-combobox-has-focus .search-input-area{border:3px solid #6ebac5}snt-search-combobox.search-combobox-is-expanded.theme-neutral .search-input-area,snt-search-combobox.search-combobox-is-expanded.theme-default .search-input-area{border:1px solid transparent;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:none;pointer-events:all;z-index:10;position:relative;margin:0px}snt-search-combobox.search-combobox-is-expanded.theme-neutral .search-results-area,snt-search-combobox.search-combobox-is-expanded.theme-default .search-results-area{display:block}@media screen and (device-aspect-ratio: 375/667){input[type=search]{font-size:14px}}';var d=function(t,s,o,e){return new(o||(o=Promise))((function(i,r){function n(t){try{h(e.next(t))}catch(s){r(s)}}function a(t){try{h(e.throw(t))}catch(s){r(s)}}function h(t){var s;t.done?i(t.value):(s=t.value,s instanceof o?s:new o((function(t){t(s)}))).then(n,a)}h((e=e.apply(t,s||[])).next())}))};const m=class{constructor(s){t(this,s),this.baseHref=r.empty(),this.searchHref=this.baseHref,this.languageStrings={},this.languageJson=r.empty()}handleSearchButtonClick(t){t.target==this.searchSntButton&&(window.location.href=this.searchHref)}onKeyDown(){window.location.href=this.searchHref}onInput(){return d(this,void 0,void 0,(function*(){const t=yield this.searchComboBox.getInputElement();this.searchHref=class{static updateQueryStringParameter(t,s,o){t||(t=window.location.href);var e,i=new RegExp("([?&])"+s+"=.*?(&|#|$)(.*)","gi");if(i.test(t))return null!=o?t.replace(i,"$1"+s+"="+o+"$2$3"):(e=t.split("#"),t=e[0].replace(i,"$1$3").replace(/(&|\?)$/,""),null!=e[1]&&(t+="#"+e[1]),t);if(null!=o){var r=-1!==t.indexOf("?")?"&":"?";return e=t.split("#"),t=e[0]+r+s+"="+o,null!=e[1]&&(t+="#"+e[1]),t}return t}}.updateQueryStringParameter(this.baseHref,"es",encodeURIComponent(t.value))}))}componentWillLoad(){try{this.languageJson&&(this.languageStrings=JSON.parse(this.languageJson))}catch(t){console.error(t)}this.baseHref=this.languageStrings.searchUrl}render(){return o("div",{class:"search-input-area"},o("snt-search-combobox",{ref:t=>this.searchComboBox=t,id:this.searchComboboxId,class:"theme-neutral","auto-complete":!0,padding:"none",onSntInput:()=>d(this,void 0,void 0,(function*(){yield this.onInput()})),onSntSearchSubmitted:this.onKeyDown.bind(this),"language-string":this.languageJson,"search-para-name":"es"}))}};m.TAG_NAME="snt-search-typeahead",m.style="snt-search-typeahead{position:relative;width:100%;max-width:47rem}snt-search-typeahead snt-search-combox .search-input-area{border-color:#e5e5e5}";export{u as snt_search_combobox,m as snt_search_typeahead}