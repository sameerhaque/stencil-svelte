import{r as e,e as t,h as i,H as s,g as n}from"./p-75b8bc7c.js";import"./p-e0123cd3.js";import"./p-85cd1ecc.js";import{W as o}from"./p-d7b2933a.js";import{K as a,a as r,N as l}from"./p-dc27d7fa.js";class c{constructor(e){this.label=e.label,this.key=e.key,this.url=e.url,this.id=e.id,this.languageId=e.languageId,this.parentId=e.parentId,this.expandable=e.expandable||!1,this.visible=e.visible||!1,this.focused=e.focused||!1,this.selected=e.selected||!1,this.expanded=e.expanded||!1,this.domElement=e.domElement||null}}const h=class{constructor(i){e(this,i),this.sntChange=t(this,"sntChange",7)}componentWillLoad(){const e=o.getObjectFromString(this.structure);this.treeitems=this.getItemsFromTree(e,this.treeitems=[]),this.keyboardEventProcessor=this.initKeyboardEventProcessor()}componentDidLoad(){}componentWillUpdate(){}componentDidUpdate(){const e=this.treeitems.find(e=>e.focused);e&&e.domElement.focus()}async getTreeitems(){return Promise.resolve(this.treeitems)}async updateExpandedTreeitems(e,t,i){return Promise.resolve(e.map(e=>-1!=t.indexOf(e)?new c({...e,expanded:"boolean"==typeof i?i:!e.expanded}):e))}async updateVisibleTreeitems(e,t,i){return Promise.resolve(e.map(e=>-1!=t.indexOf(e)?new c({...e,visible:"boolean"==typeof i?i:!e.visible}):e))}async updateFocusedTreeitems(e,t,i){return Promise.resolve(e.map(e=>t.some(t=>t.id===e.id)?new c({...e,focused:"boolean"==typeof i?i:!e.focused}):e.focused?new c({...e,focused:!1}):e))}async updateSelectedTreeitems(e,t,i){return Promise.resolve(e.map(e=>t.some(t=>t.id===e.id)?new c({...e,selected:"boolean"==typeof i?i:!e.selected}):e.selected?new c({...e,selected:!1}):e))}async findNodeByProperty(e,t){return this.treeitems.find(i=>i[e]==t)}findNodeByUrlOrKey(e){return this.treeitems.find(t=>t.key===e||t.url===e)}async selectNodeByUrlOrKey(e,t,i=!0){let s,n=await this.findNodeByUrlOrKey(e);t&&(s=this.treeitems.find(e=>e.parentId==n.id&&e.key===t)),s=s||this.treeitems.find(e=>e.parentId==n.id),s&&await this.toggleTreeitem(n,!0),this.treeitems=await this.updateFocusedTreeitems(this.treeitems,[s||n],!0);const o=s?[n,s]:[n];this.treeitems=await this.updateSelectedTreeitems(this.treeitems,o,!0),i&&this.sntChange.emit({node:s||n,parentNode:s?n:null,originalEvent:null})}async updateTreeView(e){this.structure=e;const t=o.getObjectFromString(this.structure);this.treeitems=this.getItemsFromTree(t,this.treeitems=[])}initKeyboardEventProcessor(){return a.newInstance().withKey(r.ARROW_UP,e=>{this.moveSelection(e,l.BACKWARDS)}).withKey(r.ARROW_DOWN,e=>{this.moveSelection(e,l.FORWARDS)}).withKey(r.ARROW_RIGHT,e=>{const t=this.treeitems.find(t=>t.domElement==e.target);if(t&&t.expandable){if(t.expanded)return void this.moveSelection(e,l.FORWARDS);this.toggleTreeitem(t)}}).withKey(r.ARROW_LEFT,async e=>{const t=this.treeitems.find(t=>t.domElement==e.target);if(t&&t.expandable&&t.expanded)this.toggleTreeitem(t);else if(t.parentId){const e=this.treeitems.find(e=>e.id==t.parentId);this.treeitems=await this.updateFocusedTreeitems(this.treeitems,[e])}}).withKey(r.HOME,e=>{this.moveSelection(e,l.FIRST)}).withKey(r.END,e=>{this.moveSelection(e,l.LAST)}).withKey(r.ASTERISK,e=>{const t=this.treeitems.find(t=>t.domElement==e.target);this.treeitems.filter(e=>e.expandable&&e.parentId==t.parentId).forEach(e=>{this.toggleTreeitem(e,!0)})}).withKeys([r.ENTER,r.SPACE],async e=>{e.preventDefault();const t=this.treeitems.find(t=>t.domElement==e.target);if(t)if(t.expandable)e.preventDefault(),this.toggleTreeitem(t);else{const i=this.treeitems.find(e=>e.id==t.parentId),s=i?[i,t]:[t];this.treeitems=await this.updateSelectedTreeitems(this.treeitems,s,!0),this.sntChange.emit({node:t,parentNode:i||null,originalEvent:e})}}).withDefaultHandler(async e=>{const t=this.getNextSelectableNodeByFirstCharacter(this.treeitems,e.key);t&&(this.treeitems=await this.updateFocusedTreeitems(this.treeitems,[t]))}).build()}async moveSelection(e,t){e.preventDefault();const i=this.getNextSelectableNode(this.treeitems,t);i&&(this.treeitems=await this.updateFocusedTreeitems(this.treeitems,[i]))}getNextSelectableNodeByFirstCharacter(e,t,i=l.FORWARDS){const s=e.filter(e=>e.visible&&e.label[0].toLowerCase()==t.toLowerCase()),n=s.find(e=>e.focused),o=s.indexOf(n);return s[(o+(i==l.FORWARDS?1:-1)+s.length)%s.length]}getNextSelectableNode(e,t){const i=e.filter(e=>e.visible),s=i.find(e=>e.focused),n=i.indexOf(s);return(t!=l.BACKWARDS&&t!=l.FIRST||0!=n)&&((t!=l.FORWARDS&&t!=l.LAST||n!=i.length-1)&&i[t==l.FORWARDS?n+1:t==l.BACKWARDS?n-1:t==l.LAST?i.length-1:0])}async onClickCategory(e){const t=this.treeitems.find(t=>t.domElement==e.target);t&&(e.preventDefault(),t.expandable&&(await this.toggleTreeitem(t),this.treeitems=await this.updateFocusedTreeitems(this.treeitems,[t],!0)))}async onClickLink(e,t){const i=this.treeitems.find(t=>t.id==e.parentId);this.sntChange.emit({node:e,parentNode:i||null,originalEvent:t}),this.treeitems=await this.updateFocusedTreeitems(this.treeitems,[e],!0);const s=i?[i,e]:[e];this.treeitems=await this.updateSelectedTreeitems(this.treeitems,s,!0)}async toggleTreeitem(e,t){const i=await this.updateExpandedTreeitems(this.treeitems,[e],t);e=i.find(t=>t.domElement==e.domElement);const s=i.filter(t=>t.parentId==e.id);this.treeitems=await this.updateVisibleTreeitems(i,s)}onKeydown(e){(this.keyboardEventProcessor.hasDelegatedHandler(e)||this.keyboardEventProcessor.hasDefaultHandler())&&this.keyboardEventProcessor.process(e)}async onFocusin(e){this.treeitems.find(e=>e.focused||e.selected)||(this.treeitems=await this.updateFocusedTreeitems(this.treeitems,[this.treeitems[0]]))}getItemsFromTree(e,t,i){let s=i;return e.title&&(s=new c({label:e.title,key:e.key,url:e.url,id:t.length+1,languageId:e.languageId,parentId:i?i.id:null,expandable:e.items&&e.items.length>0,expanded:!!e.expanded,visible:!i||i.expanded}),t.push(s)),e.items&&e.items.forEach(e=>{this.getItemsFromTree(e,t,s)}),t}buildTreeview(e,t,s=null){const n=e.filter(e=>e.parentId==s),o=this.treeitems.find(e=>e.selected||e.focused),a=n.reduce((s,n)=>{const a=t?t+"-"+n.key:null,r=0==e.indexOf(n);return[...s,i("li",{role:n.expandable?"treeitem":"none",id:a,"aria-expanded":n.expanded?"true":"false","data-index":n.expandable?e.indexOf(n):null,tabindex:n.expandable&&(n.focused||r&&!o)?"0":"-1",ref:e=>{n.domElement=e},class:{focused:n.focused,selected:n.selected},onClick:this.onClickCategory.bind(this)},n.expandable?[i("span",{class:"category-label"},i("span",{class:"category-label-row"},i("span",{class:"category-text","data-text":n.label},n.label)," ",i("span",{class:"icon-font iconCaret "+(n.expanded?"expanded":"")}))),this.buildTreeview(e,a,n.id)]:[i("a",{role:"treeitem",id:a+"-link",href:"javascript:void(0)",class:{focused:n.focused,selected:n.selected},"data-index":e.indexOf(n),ref:e=>{n.domElement=e},tabindex:n.focused||r&&!o?"0":"-1",onClick:e=>{this.onClickLink(n,e)}},i("span",{class:"category-text","data-text":n.label},n.label))])]},[]);return i("ul",{role:null==s?"tree":"group"},a)}render(){return i(s,{onKeydown:this.onKeydown.bind(this),onFocusin:this.onFocusin.bind(this)},this.buildTreeview(this.treeitems,this.hostElement.id))}get hostElement(){return n(this)}};h.TAG_NAME="snt-treeview",h.style='snt-treeview{display:block}snt-treeview .category-label{display:block}snt-treeview .category-label .iconCaret{padding-left:3px;font-size:10px}snt-treeview .category-label .iconCaret.expanded{-webkit-transform:rotate(-180deg);transform:rotate(-180deg);padding-right:3px;padding-left:0px}snt-treeview .category-label-row{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center}snt-treeview .category-text{display:-ms-inline-flexbox;display:inline-flex;justify-items:center;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-direction:column;flex-direction:column}snt-treeview .category-text:after{content:attr(data-text);height:0;visibility:hidden;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;font-weight:normal;font-family:"Averta-Regular"}@media speech{snt-treeview .category-text:after{display:none}}snt-treeview ul{list-style:none;padding:0}snt-treeview li,snt-treeview a{color:#323232;font-size:1rem;line-height:1.3125rem;text-decoration:none}snt-treeview li:focus,snt-treeview a:focus{outline:none}snt-treeview li:hover{cursor:pointer}snt-treeview li:hover>.category-label{font-weight:500;font-family:"Averta-ExtraBold", sans-serif;color:#147582}snt-treeview li:hover .iconCaret{font-weight:700}snt-treeview li{margin-bottom:1.25rem}snt-treeview li:last-child{margin-bottom:0}snt-treeview li.active>span{border-bottom:3px solid #147582;color:#147582}snt-treeview li>ul{padding:1rem 0 0.625rem 1.875rem}snt-treeview li>ul li{margin-bottom:1rem}snt-treeview li>ul li:last-child{margin-bottom:0}snt-treeview li>a:hover{font-weight:500;font-family:"Averta-ExtraBold", sans-serif;color:#147582;text-decoration:none}snt-treeview li:focus.focused .category-label>span{font-weight:500;font-family:"Averta-ExtraBold", sans-serif;color:#147582;outline:1px solid #147582;outline-offset:3px}snt-treeview li.selected .category-label>span{border-bottom:2px solid #147582;padding-bottom:2px;margin-bottom:-4px}snt-treeview li>span{pointer-events:none}snt-treeview li a:focus.focused>span{font-weight:500;font-family:"Averta-ExtraBold", sans-serif;color:#147582;outline:1px solid #147582;outline-offset:3px}snt-treeview a{display:block}snt-treeview a.selected>span{border-bottom:2px solid #147582;padding-bottom:2px;margin-bottom:-4px}snt-treeview a.active{border-bottom:2px solid #147582;color:#147582}snt-treeview [role=treeitem][aria-expanded=false]>ul{display:none}@media (min-width: 1024px){snt-treeview .category-label .iconCaret{font-size:12px}}';export{h as snt_treeview}