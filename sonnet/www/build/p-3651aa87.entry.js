import{r as t,e,h as i,H as s,g as n}from"./p-75b8bc7c.js";import"./p-e0123cd3.js";import"./p-85cd1ecc.js";import{W as o}from"./p-d7b2933a.js";import{K as r,a as l,N as a}from"./p-dc27d7fa.js";class d{constructor(t){this.label=t.label,this.key=t.key,this.url=t.url,this.id=t.id,this.languageId=t.languageId,this.parentId=t.parentId,this.expandable=t.expandable||!1,this.visible=t.visible||!1,this.focused=t.focused||!1,this.selected=t.selected||!1,this.expanded=t.expanded||!1,this.domElement=t.domElement||null}}var c=function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function r(t){try{a(s.next(t))}catch(e){o(e)}}function l(t){try{a(s.throw(t))}catch(e){o(e)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,l)}a((s=s.apply(t,e||[])).next())}))};const h=class{constructor(i){t(this,i),this.sntChange=e(this,"sntChange",7)}componentWillLoad(){const t=o.getObjectFromString(this.structure);this.treeitems=this.getItemsFromTree(t,this.treeitems=[]),this.keyboardEventProcessor=this.initKeyboardEventProcessor()}componentDidLoad(){}componentWillUpdate(){}componentDidUpdate(){const t=this.treeitems.find(t=>t.focused);t&&t.domElement.focus()}getTreeitems(){return c(this,void 0,void 0,(function*(){return Promise.resolve(this.treeitems)}))}updateExpandedTreeitems(t,e,i){return c(this,void 0,void 0,(function*(){return Promise.resolve(t.map(t=>-1!=e.indexOf(t)?new d(Object.assign(Object.assign({},t),{expanded:"boolean"==typeof i?i:!t.expanded})):t))}))}updateVisibleTreeitems(t,e,i){return c(this,void 0,void 0,(function*(){return Promise.resolve(t.map(t=>-1!=e.indexOf(t)?new d(Object.assign(Object.assign({},t),{visible:"boolean"==typeof i?i:!t.visible})):t))}))}updateFocusedTreeitems(t,e,i){return c(this,void 0,void 0,(function*(){return Promise.resolve(t.map(t=>e.some(e=>e.id===t.id)?new d(Object.assign(Object.assign({},t),{focused:"boolean"==typeof i?i:!t.focused})):t.focused?new d(Object.assign(Object.assign({},t),{focused:!1})):t))}))}updateSelectedTreeitems(t,e,i){return c(this,void 0,void 0,(function*(){return Promise.resolve(t.map(t=>e.some(e=>e.id===t.id)?new d(Object.assign(Object.assign({},t),{selected:"boolean"==typeof i?i:!t.selected})):t.selected?new d(Object.assign(Object.assign({},t),{selected:!1})):t))}))}findNodeByProperty(t,e){return c(this,void 0,void 0,(function*(){return this.treeitems.find(i=>i[t]==e)}))}findNodeByUrlOrKey(t){return this.treeitems.find(e=>e.key===t||e.url===t)}selectNodeByUrlOrKey(t,e,i=!0){return c(this,void 0,void 0,(function*(){let s,n=yield this.findNodeByUrlOrKey(t);e&&(s=this.treeitems.find(t=>t.parentId==n.id&&t.key===e)),s=s||this.treeitems.find(t=>t.parentId==n.id),s&&(yield this.toggleTreeitem(n,!0)),this.treeitems=yield this.updateFocusedTreeitems(this.treeitems,[s||n],!0);const o=s?[n,s]:[n];this.treeitems=yield this.updateSelectedTreeitems(this.treeitems,o,!0),i&&this.sntChange.emit({node:s||n,parentNode:s?n:null,originalEvent:null})}))}updateTreeView(t){return c(this,void 0,void 0,(function*(){this.structure=t;const e=o.getObjectFromString(this.structure);this.treeitems=this.getItemsFromTree(e,this.treeitems=[])}))}initKeyboardEventProcessor(){return r.newInstance().withKey(l.ARROW_UP,t=>{this.moveSelection(t,a.BACKWARDS)}).withKey(l.ARROW_DOWN,t=>{this.moveSelection(t,a.FORWARDS)}).withKey(l.ARROW_RIGHT,t=>{const e=this.treeitems.find(e=>e.domElement==t.target);if(e&&e.expandable){if(e.expanded)return void this.moveSelection(t,a.FORWARDS);this.toggleTreeitem(e)}}).withKey(l.ARROW_LEFT,t=>c(this,void 0,void 0,(function*(){const e=this.treeitems.find(e=>e.domElement==t.target);if(e&&e.expandable&&e.expanded)this.toggleTreeitem(e);else if(e.parentId){const t=this.treeitems.find(t=>t.id==e.parentId);this.treeitems=yield this.updateFocusedTreeitems(this.treeitems,[t])}}))).withKey(l.HOME,t=>{this.moveSelection(t,a.FIRST)}).withKey(l.END,t=>{this.moveSelection(t,a.LAST)}).withKey(l.ASTERISK,t=>{const e=this.treeitems.find(e=>e.domElement==t.target);this.treeitems.filter(t=>t.expandable&&t.parentId==e.parentId).forEach(t=>{this.toggleTreeitem(t,!0)})}).withKeys([l.ENTER,l.SPACE],t=>c(this,void 0,void 0,(function*(){t.preventDefault();const e=this.treeitems.find(e=>e.domElement==t.target);if(e)if(e.expandable)t.preventDefault(),this.toggleTreeitem(e);else{const i=this.treeitems.find(t=>t.id==e.parentId),s=i?[i,e]:[e];this.treeitems=yield this.updateSelectedTreeitems(this.treeitems,s,!0),this.sntChange.emit({node:e,parentNode:i||null,originalEvent:t})}}))).withDefaultHandler(t=>c(this,void 0,void 0,(function*(){const e=this.getNextSelectableNodeByFirstCharacter(this.treeitems,t.key);e&&(this.treeitems=yield this.updateFocusedTreeitems(this.treeitems,[e]))}))).build()}moveSelection(t,e){return c(this,void 0,void 0,(function*(){t.preventDefault();const i=this.getNextSelectableNode(this.treeitems,e);i&&(this.treeitems=yield this.updateFocusedTreeitems(this.treeitems,[i]))}))}getNextSelectableNodeByFirstCharacter(t,e,i=a.FORWARDS){const s=t.filter(t=>t.visible&&t.label[0].toLowerCase()==e.toLowerCase()),n=s.find(t=>t.focused),o=s.indexOf(n);return s[(o+(i==a.FORWARDS?1:-1)+s.length)%s.length]}getNextSelectableNode(t,e){const i=t.filter(t=>t.visible),s=i.find(t=>t.focused),n=i.indexOf(s);return(e!=a.BACKWARDS&&e!=a.FIRST||0!=n)&&((e!=a.FORWARDS&&e!=a.LAST||n!=i.length-1)&&i[e==a.FORWARDS?n+1:e==a.BACKWARDS?n-1:e==a.LAST?i.length-1:0])}onClickCategory(t){return c(this,void 0,void 0,(function*(){const e=this.treeitems.find(e=>e.domElement==t.target);e&&(t.preventDefault(),e.expandable&&(yield this.toggleTreeitem(e),this.treeitems=yield this.updateFocusedTreeitems(this.treeitems,[e],!0)))}))}onClickLink(t,e){return c(this,void 0,void 0,(function*(){const i=this.treeitems.find(e=>e.id==t.parentId);this.sntChange.emit({node:t,parentNode:i||null,originalEvent:e}),this.treeitems=yield this.updateFocusedTreeitems(this.treeitems,[t],!0);const s=i?[i,t]:[t];this.treeitems=yield this.updateSelectedTreeitems(this.treeitems,s,!0)}))}toggleTreeitem(t,e){return c(this,void 0,void 0,(function*(){const i=yield this.updateExpandedTreeitems(this.treeitems,[t],e);t=i.find(e=>e.domElement==t.domElement);const s=i.filter(e=>e.parentId==t.id);this.treeitems=yield this.updateVisibleTreeitems(i,s)}))}onKeydown(t){(this.keyboardEventProcessor.hasDelegatedHandler(t)||this.keyboardEventProcessor.hasDefaultHandler())&&this.keyboardEventProcessor.process(t)}onFocusin(t){return c(this,void 0,void 0,(function*(){this.treeitems.find(t=>t.focused||t.selected)||(this.treeitems=yield this.updateFocusedTreeitems(this.treeitems,[this.treeitems[0]]))}))}getItemsFromTree(t,e,i){let s=i;return t.title&&(s=new d({label:t.title,key:t.key,url:t.url,id:e.length+1,languageId:t.languageId,parentId:i?i.id:null,expandable:t.items&&t.items.length>0,expanded:!!t.expanded,visible:!i||i.expanded}),e.push(s)),t.items&&t.items.forEach(t=>{this.getItemsFromTree(t,e,s)}),e}buildTreeview(t,e,s=null){const n=t.filter(t=>t.parentId==s),o=this.treeitems.find(t=>t.selected||t.focused),r=n.reduce((s,n)=>{const r=e?e+"-"+n.key:null,l=0==t.indexOf(n);return[...s,i("li",{role:n.expandable?"treeitem":"none",id:r,"aria-expanded":n.expanded?"true":"false","data-index":n.expandable?t.indexOf(n):null,tabindex:n.expandable&&(n.focused||l&&!o)?"0":"-1",ref:t=>{n.domElement=t},class:{focused:n.focused,selected:n.selected},onClick:this.onClickCategory.bind(this)},n.expandable?[i("span",{class:"category-label"},i("span",{class:"category-label-row"},i("span",{class:"category-text","data-text":n.label},n.label)," ",i("span",{class:"icon-font iconCaret "+(n.expanded?"expanded":"")}))),this.buildTreeview(t,r,n.id)]:[i("a",{role:"treeitem",id:r+"-link",href:"javascript:void(0)",class:{focused:n.focused,selected:n.selected},"data-index":t.indexOf(n),ref:t=>{n.domElement=t},tabindex:n.focused||l&&!o?"0":"-1",onClick:t=>{this.onClickLink(n,t)}},i("span",{class:"category-text","data-text":n.label},n.label))])]},[]);return i("ul",{role:null==s?"tree":"group"},r)}render(){return i(s,{onKeydown:this.onKeydown.bind(this),onFocusin:this.onFocusin.bind(this)},this.buildTreeview(this.treeitems,this.hostElement.id))}get hostElement(){return n(this)}};h.TAG_NAME="snt-treeview",h.style='snt-treeview{display:block}snt-treeview .category-label{display:block}snt-treeview .category-label .iconCaret{padding-left:3px;font-size:10px}snt-treeview .category-label .iconCaret.expanded{-webkit-transform:rotate(-180deg);transform:rotate(-180deg);padding-right:3px;padding-left:0px}snt-treeview .category-label-row{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center}snt-treeview .category-text{display:-ms-inline-flexbox;display:inline-flex;justify-items:center;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-direction:column;flex-direction:column}snt-treeview .category-text:after{content:attr(data-text);height:0;visibility:hidden;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;font-weight:normal;font-family:"Averta-Regular"}@media speech{snt-treeview .category-text:after{display:none}}snt-treeview ul{list-style:none;padding:0}snt-treeview li,snt-treeview a{color:#323232;font-size:1rem;line-height:1.3125rem;text-decoration:none}snt-treeview li:focus,snt-treeview a:focus{outline:none}snt-treeview li:hover{cursor:pointer}snt-treeview li:hover>.category-label{font-weight:500;font-family:"Averta-ExtraBold", sans-serif;color:#147582}snt-treeview li:hover .iconCaret{font-weight:700}snt-treeview li{margin-bottom:1.25rem}snt-treeview li:last-child{margin-bottom:0}snt-treeview li.active>span{border-bottom:3px solid #147582;color:#147582}snt-treeview li>ul{padding:1rem 0 0.625rem 1.875rem}snt-treeview li>ul li{margin-bottom:1rem}snt-treeview li>ul li:last-child{margin-bottom:0}snt-treeview li>a:hover{font-weight:500;font-family:"Averta-ExtraBold", sans-serif;color:#147582;text-decoration:none}snt-treeview li:focus.focused .category-label>span{font-weight:500;font-family:"Averta-ExtraBold", sans-serif;color:#147582;outline:1px solid #147582;outline-offset:3px}snt-treeview li.selected .category-label>span{border-bottom:2px solid #147582;padding-bottom:2px;margin-bottom:-4px}snt-treeview li>span{pointer-events:none}snt-treeview li a:focus.focused>span{font-weight:500;font-family:"Averta-ExtraBold", sans-serif;color:#147582;outline:1px solid #147582;outline-offset:3px}snt-treeview a{display:block}snt-treeview a.selected>span{border-bottom:2px solid #147582;padding-bottom:2px;margin-bottom:-4px}snt-treeview a.active{border-bottom:2px solid #147582;color:#147582}snt-treeview [role=treeitem][aria-expanded=false]>ul{display:none}@media (min-width: 1024px){snt-treeview .category-label .iconCaret{font-size:12px}}';export{h as snt_treeview}